function convert() {
            const lines = input.value.split('\n');
            const converted = lines.map(line => {
                let p = line.trim();
                if (!p) return '<div style="height: 15px;"></div>';
                
                // 1. [텍스트](이미지주소) 마크다운 형식 처리 (가장 먼저 실행)
                p = p.replace(/\[.*?\]\((https?:\/\/.*?\.(?:png|jpg|jpeg|gif|webp)(?:\?.*)?)\)/gi, '<img src="$1">');

                // 2. /명령어 제거
                p = p.replace(/^\/\w+\s+/, ''); 

                // 3. 주소만 단독으로 있는 경우 이미지로 변환
                if (/^(https?:\/\/.*\.(?:png|jpg|jpeg|gif|webp)(?:\?.*)?)$/i.test(p)) {
                    return `<div style="display:block; text-align:center;"><img src="${p}"></div>`;
                }

                // 4. Roll20 스타일 수식 변환
                p = p.replace(/\[([\s\S]*?)\]\(([\s\S]*?)style="([\s\S]*?)"?\)/g, (match, p1, p2, p3) => {
                    let content = p1.replace(/\?\{([^|}]*).*?\}/g, '$1');
                    if (!content.trim()) content = '　';

                    let s = p3.replace(/&#41;/g, ')').replace(/&quot;/g, '"')
                              .replace(/[\u00A0\u1680​\u180E\u2000-\u200B\u202F\u205F\u3000]/g, ' ')
                              .trim();

                    if (s.includes('box-shadow')) s += " margin-top: 20px; margin-bottom: 20px;";

                    const oc = (s.match(/\(/g) || []).length;
                    const cc = (s.match(/\)/g) || []).length;
                    if (oc > cc) s += ')'.repeat(oc - cc);
                    if (!s.endsWith(';')) s += ';';

                    const isBlock = s.includes('display:block') || s.includes('display: block');
                    const tag = isBlock ? 'div' : 'span';
                    
                    return `<${tag} style="${s} box-sizing: border-box;">${content}</${tag}>`;
                });

                return `<div class="msg-line">${p}</div>`;
            }).join('');
            output.innerHTML = converted;
        }
